{"version":3,"file":"kaysh.cjs.production.min.js","sources":["../src/lib/_aux.ts","../src/lib/simple-cache-store.ts","../src/lib/rxjs-cache-store.ts"],"sourcesContent":["export function __strToHash(str = ''): string {\r\n  let hash = 0,\r\n    i,\r\n    chr;\r\n\r\n  for (i = 0; i < str.length; i++) {\r\n    chr = str.charCodeAt(i);\r\n    hash = (hash << 5) - hash + chr;\r\n    hash |= 0;\r\n  }\r\n\r\n  return hash.toString(36);\r\n}\r\n\r\nfunction getShortValue(val: any) {\r\n  if (Number.isInteger(val) && String(val).length) return 'num_' + val;\r\n\r\n  if (typeof val === 'string') {\r\n    if (val.length === 0) return 'emptyString__';\r\n    return 'str_' + val;\r\n  }\r\n\r\n  if (Array.isArray(val)) {\r\n    if (val.length === 0) return 'emptyArray__';\r\n\r\n    if (val.length === 1) {\r\n      if (Number.isInteger(val[0]) && String(val[0]).length) return '_num_' + val[0];\r\n\r\n      if (typeof val[0] === 'string') {\r\n        if (val[0].length === 0) return '_emptyString__';\r\n        return '_str_' + val[0];\r\n      }\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nexport function __objToHash(val: any, fast = true) {\r\n  if (val === undefined) return '__undefined__';\r\n  if (val === null) return '__null__';\r\n\r\n  if (fast) {\r\n    let shortValue = getShortValue(val);\r\n    if (shortValue != null && shortValue.length > 0 && shortValue.length < 32) return shortValue;\r\n  }\r\n\r\n  return __strToHash(JSON.stringify(val));\r\n}\r\n","import { __objToHash } from './_aux';\r\n\r\nconst _isTest = process.env.NODE_ENV === 'test';\r\n\r\nif (_isTest) if (false) console.log('test');\r\n\r\nconst _log = console.log;\r\n\r\nlet _localStorageParentKey = 'KAYSH-V1';\r\nlet _localStorageMaxGlobalTime = 0;\r\nlet _localStorage;\r\nlet _localStorageLoaded = false;\r\nlet _keyshEnabled = true;\r\nlet _keyshLocalStorageEnabled = true;\r\ndeclare var window;\r\n\r\nconst memoFuncPrefixId = 'KAYSH-CACHE-MEMO-FUNC__';\r\n\r\n_localStorage = window?.localStorage;\r\n\r\nexport interface StoredValueModelObjRoot {\r\n  [key: string]: StoredValueModelObj;\r\n}\r\n\r\nexport interface StoredValueModelObj {\r\n  [key: string]: StoredValueModel;\r\n}\r\n\r\nexport interface StoredValueModel {\r\n  value: any;\r\n  date: number;\r\n  localStored?: boolean;\r\n  config?: DefaultConfigCacheModel;\r\n}\r\n\r\nexport interface DefaultConfigCacheModel {\r\n  localStorage?: boolean;\r\n  maxTime?: number;\r\n  maxItems?: number;\r\n}\r\n\r\nconst defaultConfig: DefaultConfigCacheModel = {\r\n  localStorage: false,\r\n  maxTime: 0,\r\n  maxItems: 10,\r\n};\r\n\r\nlet store_state: StoredValueModelObjRoot = {};\r\n\r\nfunction setCacheValue(key: string, value: any, payloadToHash?: any, config?: DefaultConfigCacheModel) {\r\n  if (_keyshEnabled !== true) return;\r\n  if (key == null) return;\r\n  if (value === undefined) return;\r\n\r\n  const _hash = __objToHash(payloadToHash);\r\n\r\n  const _obj = {\r\n    value,\r\n    date: Date.now().valueOf(),\r\n    localStored: false,\r\n    config: {\r\n      ...defaultConfig,\r\n      ...(config || (store_state[key] || {})?.config),\r\n    },\r\n  };\r\n\r\n  //Add Obj\r\n  let stateObjs: StoredValueModelObj = {\r\n    ...store_state[key],\r\n    [_hash]: _obj,\r\n  };\r\n\r\n  //Check MaxItems\r\n  let maxItems = Number(_obj?.config?.maxItems);\r\n  let obj = store_state[key];\r\n  if (obj != null && Object.keys(obj).length > Number(maxItems)) stateObjs = __sortStoredValueModelByDate(stateObjs, maxItems);\r\n\r\n  store_state[key] = stateObjs;\r\n\r\n  if (false) _log(JSON.stringify({ store_state, _hash, payloadToHash }, null, 2));\r\n\r\n  if (__isValidLocalStorageItem(value) && config?.localStorage === true) __updateLocalStorage();\r\n\r\n  //check Promise\r\n  if (__isPromise(value)) {\r\n    value.then(_val => {\r\n      if (_val != null) setCacheValue(key, _val, payloadToHash, config);\r\n    });\r\n  }\r\n}\r\n\r\nfunction getCacheValue(key: string, payloadToHash?: any): any {\r\n  if (_keyshEnabled !== true) return null;\r\n\r\n  if (true && typeof window !== 'undefined' && _localStorageLoaded === false) __setLocalStoredToStore();\r\n\r\n  if (store_state[key] == null) return store_state[key];\r\n\r\n  const _hash = __objToHash(payloadToHash);\r\n  const objKeyValue: StoredValueModel = store_state[key][_hash];\r\n  if (objKeyValue == null) return objKeyValue;\r\n\r\n  if (false && _isTest) _log(JSON.stringify(store_state, null, 2));\r\n\r\n  //Is maxTime\r\n  if ((objKeyValue.config?.maxTime || objKeyValue.config.localStorage) && !__checkValidItemDate(objKeyValue)) return null;\r\n\r\n  if (objKeyValue.value == null) return objKeyValue.value;\r\n\r\n  if (typeof objKeyValue.value === 'object') return Object.freeze(objKeyValue.value);\r\n\r\n  return objKeyValue.value;\r\n}\r\n\r\nfunction resetCache(key: string, payloadToHash?: any) {\r\n  if (key == null) return;\r\n\r\n  if (payloadToHash !== undefined) {\r\n    const _hash = __objToHash(payloadToHash);\r\n    if (store_state && key in store_state && _hash in store_state[key]) {\r\n      let resetLocalStorage = __isLocalStorageItem(store_state[key][_hash]);\r\n\r\n      delete store_state[key][_hash];\r\n\r\n      if (resetLocalStorage) __updateLocalStorage();\r\n    }\r\n    return;\r\n  }\r\n\r\n  if (store_state && key in store_state) {\r\n    delete store_state[key];\r\n    __updateLocalStorage();\r\n  }\r\n}\r\n\r\nfunction resetAllCaches() {\r\n  store_state = {};\r\n  __clearLocalStorage();\r\n}\r\n\r\nfunction memoFunction(func: Function, prefixId: string = memoFuncPrefixId, config?: DefaultConfigCacheModel): Function {\r\n  let funcName = func.name || '__memoized';\r\n  let funcKey = prefixId + func.name;\r\n\r\n  if (false) _log('funcName', funcName);\r\n\r\n  var object = {\r\n    [funcName]: function(...restArgs) {\r\n      const cache = getCacheValue(funcKey, restArgs);\r\n      if (cache !== undefined) return cache;\r\n\r\n      const res = func.apply(this, restArgs);\r\n      setCacheValue(funcKey, res, restArgs, config);\r\n      return res;\r\n    },\r\n  };\r\n\r\n  return object[funcName];\r\n}\r\n\r\nfunction resetMemoFunction(funcOrName: Function | string, prefixId: string = memoFuncPrefixId): Function {\r\n  let funcKey;\r\n\r\n  if (typeof funcOrName === 'string') {\r\n    funcKey = prefixId + funcOrName;\r\n  } else {\r\n    funcKey = prefixId + funcOrName.name;\r\n  }\r\n\r\n  const memoizedReset = function(...restArgs) {\r\n    if (restArgs !== undefined && restArgs.length) {\r\n      resetCache(funcKey, restArgs);\r\n    } else {\r\n      resetCache(funcKey);\r\n    }\r\n  };\r\n\r\n  return memoizedReset;\r\n}\r\n\r\nfunction memoFunctionDecorator(config?: DefaultConfigCacheModel, prefixId?) {\r\n  const instanceMap = new WeakMap();\r\n  return (target, propertyKey, descriptor) => {\r\n    const input = target[propertyKey]; // eslint-disable-line @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-member-access\r\n\r\n    if (typeof input !== 'function') {\r\n      throw new TypeError('The decorated value must be a function');\r\n    }\r\n\r\n    delete descriptor.value;\r\n    delete descriptor.writable;\r\n\r\n    descriptor.get = function() {\r\n      if (!instanceMap.has(this)) {\r\n        const value = memoFunction(input, prefixId, config);\r\n        instanceMap.set(this, value);\r\n        return value;\r\n      }\r\n      return instanceMap.get(this);\r\n    };\r\n  };\r\n}\r\n\r\nfunction __sortStoredValueModelByDate(StoredValuel: StoredValueModelObj, max: number = Infinity): StoredValueModelObj {\r\n  return Object.entries({ ...StoredValuel })\r\n    .sort(([, a], [, b]) => Number(b.date) - Number(a.date))\r\n    .slice(0, max)\r\n    .reduce((r, [k, v]) => ({ ...r, [k]: v }), {} as any);\r\n}\r\n\r\nfunction __isRxjsObservableObj(value: any) {\r\n  if (value == null) return false;\r\n\r\n  if (__isObservable(value)) return true;\r\n\r\n  return typeof value === 'object' && '_isScalar' in value && 'source' in value;\r\n}\r\n\r\nfunction __isFunction(value: any): boolean {\r\n  return value != null && typeof value === 'function';\r\n}\r\n\r\nfunction __isObservable(value: any): boolean {\r\n  return value != null && typeof value === 'object' && __isFunction(value.lift) && __isFunction(value.subscribe);\r\n}\r\n\r\nfunction __isPromise(value: any): boolean {\r\n  return value != null && Object.prototype.toString.call(value) === '[object Promise]';\r\n}\r\n\r\nfunction __isValidLocalStorageItem(val): boolean {\r\n  return !__isRxjsObservableObj(val) && !__isPromise(val);\r\n}\r\n\r\nfunction __isLocalStorageItem(val, isToLoadData = false): boolean {\r\n  let rv = __isValidLocalStorageItem(val) && val?.config?.localStorage === true && val?.date > 0;\r\n\r\n  if (isToLoadData) {\r\n    rv = rv && val.localStored === true;\r\n  }\r\n\r\n  return rv;\r\n}\r\n\r\nfunction __filterLocalStorageItems(state: any, isToLoadData?: boolean) {\r\n  if (state == null) return state;\r\n\r\n  let rv = {};\r\n  let _state = { ...state };\r\n\r\n  Object.entries(_state).forEach(([key, value]) => {\r\n    if (value != null && typeof value === 'object' && Object.keys(value).length > 0) {\r\n      //SUBKEY\r\n      rv[key] = { ..._state[key] };\r\n\r\n      Object.entries(value).forEach(([key2, value2]) => {\r\n        if (__isLocalStorageItem(value2, isToLoadData)) {\r\n          rv[key][key2] = { ...value2, localStored: true };\r\n        } else {\r\n          delete rv[key][key2];\r\n        }\r\n      });\r\n\r\n      if (Object.keys(rv[key]).length === 0) {\r\n        if (key in rv) delete rv[key];\r\n      }\r\n    } else {\r\n      if (key in rv) delete rv[key];\r\n    }\r\n  });\r\n\r\n  return rv;\r\n}\r\n\r\nfunction __updateLocalStorage() {\r\n  if (_keyshEnabled !== true || _keyshLocalStorageEnabled !== true) return null;\r\n\r\n  if (!_localStorage?.setItem) return;\r\n\r\n  let store_stateClone = __filterLocalStorageItems(store_state);\r\n\r\n  if (store_stateClone != null && typeof store_stateClone === 'object' && Object.keys(store_stateClone).length > 0) {\r\n    _localStorage.setItem(_localStorageParentKey, JSON.stringify(store_stateClone));\r\n  } else {\r\n    __clearLocalStorage();\r\n  }\r\n\r\n  if (false) _log('[updateLocalStorage]', JSON.stringify(store_stateClone, null, 2));\r\n  if (false) _log('[updateLocalStorage]', JSON.stringify(store_state, null, 2));\r\n}\r\n\r\nfunction __checkValidItemDate(objKeyValue: StoredValueModel): boolean {\r\n  let max = Number(objKeyValue.config?.maxTime);\r\n\r\n  if (objKeyValue.config.localStorage && _localStorageMaxGlobalTime > 0) {\r\n    max = max === 0 ? _localStorageMaxGlobalTime : Math.min(max, _localStorageMaxGlobalTime);\r\n  }\r\n\r\n  if (!(max > 0)) return true;\r\n\r\n  let now = Date.now().valueOf();\r\n  let date = Number(objKeyValue.date);\r\n  let maxDate = date + max;\r\n\r\n  return !(now > maxDate);\r\n}\r\n\r\nfunction __getLocalStorageClass() {\r\n  return _localStorage;\r\n}\r\n\r\nfunction __setLocalStoredToStore() {\r\n  if (_keyshEnabled !== true || _keyshLocalStorageEnabled !== true) return null;\r\n\r\n  if (_localStorage?.getItem == null || !_localStorageParentKey?.length) return;\r\n  if (!_isTest && _localStorageLoaded) return;\r\n\r\n  const dataStored = _localStorage.getItem(_localStorageParentKey);\r\n\r\n  if (dataStored == null) return;\r\n\r\n  let storeStateObject = JSON.parse(dataStored);\r\n\r\n  if (storeStateObject != null) {\r\n    store_state = __filterLocalStorageItems(storeStateObject, true);\r\n    _localStorageLoaded = true;\r\n  }\r\n}\r\n\r\nfunction __getLocalStorageGlobalKey() {\r\n  return _localStorageParentKey;\r\n}\r\n\r\nfunction __setLocalStorageGlobals(\r\n  parentKey: string,\r\n  maxGlobalTime: number = null,\r\n  enabled: boolean = null,\r\n  localStorageEnabled: boolean = null\r\n) {\r\n  if (parentKey == null && maxGlobalTime == null) return;\r\n\r\n  __clearLocalStorage();\r\n\r\n  if (parentKey != null) _localStorageParentKey = parentKey;\r\n\r\n  if (maxGlobalTime != null) _localStorageMaxGlobalTime = maxGlobalTime;\r\n\r\n  if (enabled != null) _keyshEnabled = !!enabled;\r\n\r\n  if (localStorageEnabled != null) _keyshLocalStorageEnabled = !!localStorageEnabled;\r\n}\r\n\r\nfunction __clearLocalStorage() {\r\n  if (_localStorage?.removeItem == null) return;\r\n\r\n  _localStorage.removeItem(_localStorageParentKey);\r\n\r\n  _localStorageLoaded = false;\r\n}\r\n\r\nfunction __getStoreState() {\r\n  if (store_state == null) return null;\r\n\r\n  return Object.freeze({ ...store_state } as any);\r\n}\r\n\r\nfunction __simulateRefresh() {\r\n  if (_isTest) {\r\n    if (false) _log('[simulateRefresh]');\r\n    store_state = {};\r\n    __setLocalStoredToStore();\r\n  }\r\n}\r\n\r\nconst __simpleCacheStore = {\r\n  setCacheValue,\r\n  getCacheValue,\r\n  resetCache,\r\n  resetAllCaches,\r\n  memoFunction,\r\n  memoFunctionDecorator,\r\n  resetMemoFunction,\r\n  __getLocalStorageClass,\r\n  __setLocalStoredToStore,\r\n  __clearLocalStorage,\r\n  __getLocalStorageGlobalKey,\r\n  __getStoreState,\r\n  __sortStoredValueModelByDate,\r\n  __simulateRefresh,\r\n  __setLocalStorageGlobals,\r\n  __isPromise,\r\n};\r\n\r\nexport { __simpleCacheStore };\r\n","import { of } from 'rxjs';\r\nimport { Observable } from 'rxjs/internal/Observable';\r\nimport { isObservable } from 'rxjs/internal/util/isObservable';\r\nimport { shareReplay, tap } from 'rxjs/operators';\r\nimport { DefaultConfigCacheModel, __simpleCacheStore } from './simple-cache-store';\r\n\r\nconst getRxjsObservableCacheValue = (key: string, payloadToHash?: any): Observable<any> => {\r\n  const cache = __simpleCacheStore.getCacheValue(key, payloadToHash);\r\n\r\n  if (cache == null) return cache;\r\n\r\n  if (isObservable(cache)) return cache;\r\n\r\n  return of(cache);\r\n};\r\n\r\nconst setRxjsObservableCacheValue = (\r\n  stream: Observable<any>,\r\n  key: string,\r\n  payloadToHash?: any,\r\n  config?: DefaultConfigCacheModel\r\n): Observable<any> => {\r\n  if (stream == null || key == null) return of(null);\r\n\r\n  const setCache = ($data: any) => {\r\n    if ($data != null) __simpleCacheStore.setCacheValue(key, $data, payloadToHash, config);\r\n  };\r\n\r\n  setCache(stream.pipe(shareReplay()));\r\n\r\n  return stream.pipe(\r\n    tap((_data: any) => setCache(_data)),\r\n    shareReplay()\r\n  );\r\n};\r\n\r\nconst __rxCacheStore = {\r\n  getRxjsObservableCacheValue,\r\n  setRxjsObservableCacheValue,\r\n  resetCache: __simpleCacheStore.resetCache,\r\n  resetAllCaches: __simpleCacheStore.resetAllCaches,\r\n};\r\n\r\nexport { __rxCacheStore as __rxjsCacheStore };\r\n"],"names":["__objToHash","val","fast","undefined","shortValue","Number","isInteger","String","length","Array","isArray","getShortValue","str","i","hash","charCodeAt","toString","__strToHash","JSON","stringify","_localStorage","_localStorageParentKey","_localStorageMaxGlobalTime","_localStorageLoaded","_keyshEnabled","_keyshLocalStorageEnabled","window","_window","localStorage","defaultConfig","maxTime","maxItems","store_state","setCacheValue","key","value","payloadToHash","config","_hash","_obj","date","Date","now","valueOf","localStored","_ref","stateObjs","_obj$config","obj","Object","keys","__sortStoredValueModelByDate","__isValidLocalStorageItem","__updateLocalStorage","__isPromise","then","_val","getCacheValue","__setLocalStoredToStore","objKeyValue","max","_objKeyValue$config2","Math","min","__checkValidItemDate","freeze","resetCache","resetLocalStorage","__isLocalStorageItem","memoFunction","func","prefixId","funcName","name","funcKey","restArgs","cache","res","apply","this","StoredValuel","Infinity","entries","sort","a","slice","reduce","r","__isFunction","prototype","call","lift","subscribe","__isObservable","isToLoadData","rv","__filterLocalStorageItems","state","_state","forEach","key2","value2","_localStorage2","setItem","store_stateClone","__clearLocalStorage","getItem","_localStorageParentKe","dataStored","storeStateObject","parse","removeItem","__simpleCacheStore","resetAllCaches","memoFunctionDecorator","instanceMap","WeakMap","target","propertyKey","descriptor","input","TypeError","writable","get","has","set","resetMemoFunction","funcOrName","__getLocalStorageClass","__getLocalStorageGlobalKey","__getStoreState","__simulateRefresh","__setLocalStorageGlobals","parentKey","maxGlobalTime","enabled","localStorageEnabled","getRxjsObservableCacheValue","isObservable","of","setRxjsObservableCacheValue","stream","setCache","$data","pipe","shareReplay","tap","_data"],"mappings":"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"}